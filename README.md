# TaskMate Phase 1 – ربات تلگرام متصل به ابزارهای مدیریت پروژه

این مخزن با هدف پیاده‌سازی گام‌به‌گام فاز اول محصول TaskMate آماده شده است. در این فاز تنها بر ساخت یک ربات تلگرام تمرکز می‌کنیم که بتواند:

- برای هر کاربر، یک فضای کاری شخصی در ابزار مدیریت پروژه (در حال حاضر Trello) بسازد.
- پیام‌های متنی، عکس‌ها و ویس‌های ارسالی کاربر را دریافت و به کارت/تسک تبدیل کند.
- همه چیز را با حداقل پیش‌نیاز راه‌اندازی کند تا حتی اگر هیچ تجربه‌ای ندارید بتوانید از صفر شروع کنید.

> **نکته:** ساختار کد به گونه‌ای طراحی شده تا بتوانیم در آینده اتصال به ابزارهای دیگر (مانند ClickUp یا Asana) و همچنین دیتابیس داخلی را به سادگی اضافه کنیم.

---

## فهرست مطالب

1. [پیش‌نیازهای نرم‌افزاری](#پیشنیازهای-نرم‌افزاری)
2. [قدم صفر: ساخت ربات تلگرام](#قدم-صفر-ساخت-ربات-تلگرام)
3. [قدم یک: گرفتن کلیدهای Trello](#قدم-یک-گرفتن-کلیدهای-trello)
4. [قدم دو: آماده‌سازی محیط برنامه‌نویسی](#قدم-دو-آمادهسازی-محیط-برنامه‌نویسی)
5. [قدم سه: تنظیم متغیرهای محیطی](#قدم-سه-تنظیم-متغیرهای-محیطی)
6. [قدم چهار: نصب وابستگی‌ها و اجرای ربات](#قدم-چهار-نصب-وابستگیها-و-اجرای-ربات)
7. [قدم پنج: شیوه کار با ربات](#قدم-پنج-شیوه-کار-با-ربات)
8. [عیب‌یابی سریع](#عیبیابی-سریع)
9. [نقشه راه گسترش فاز یک](#نقشه-راه-گسترش-فاز-یک)
10. [نگاه به آینده (فازهای بعدی)](#نگاه-به-آینده-فازهای-بعدی)

---

## پیش‌نیازهای نرم‌افزاری

اگر هیچ تجربه‌ای ندارید، کافی است موارد زیر را نصب کنید:

- [Python 3.11](https://www.python.org/downloads/) یا نسخه بالاتر.
- یک ویرایشگر متن ساده مثل [Visual Studio Code](https://code.visualstudio.com/).
- دسترسی به اینترنت برای دانلود بسته‌ها و ارتباط با APIها.

**اختیاری ولی پیشنهاد شده:**

- نصب Git برای مدیریت نسخه‌ها.
- نصب ابزار Postman یا Insomnia برای مشاهده درخواست‌های API.

---

## قدم صفر: ساخت ربات تلگرام

1. در تلگرام به حساب کاربری `@BotFather` پیام بدهید.
2. دستور `/newbot` را ارسال کنید و نام ربات را انتخاب کنید.
3. BotFather در پایان پیامی حاوی **Token** به شما می‌دهد. این مقدار را کپی کنید؛ بعداً در فایل `.env` قرار می‌دهیم.
4. برای آزمایش اولیه می‌توانید دستور `/start` را در چت با ربات جدید ارسال کنید، اما فعلاً پاسخی نمی‌گیرید تا کد را اجرا کنیم.

---

## قدم یک: گرفتن کلیدهای Trello

1. وارد حساب کاربری Trello شوید یا اگر ندارید، رایگان ثبت‌نام کنید.
2. به آدرس <https://trello.com/app-key> بروید.
3. مقدار **API Key** را کپی کنید.
4. دکمهٔ «Token» در همان صفحه را فشار دهید، وارد حساب شوید و اجازه دسترسی بدهید تا **API Token** بسازید.
5. هر دو مقدار Key و Token را نگه دارید؛ در فایل `.env` استفاده خواهند شد.

---

## قدم دو: آماده‌سازی محیط برنامه‌نویسی

تمام دستورات زیر را در ترمینال (Command Prompt در ویندوز یا Terminal در macOS/Linux) اجرا کنید. اگر تا حالا ترمینال باز نکرده‌اید، نگران نباشید؛ قدم به قدم همراهی‌تان می‌کنیم.

```bash
# ۱) به پوشه‌ای که پروژه در آن است بروید
cd path/to/TaskMateAi

# ۲) یک محیط مجازی بسازید (فقط بار اول لازم است)
python -m venv .venv

# ۳) محیط مجازی را فعال کنید
# ویندوز
.venv\Scripts\activate
# مک یا لینوکس
source .venv/bin/activate
```

بعد از فعال‌سازی محیط مجازی، در ابتدای خط ترمینال عبارت `(venv)` یا مشابه آن را می‌بینید.

---

## قدم سه: تنظیم متغیرهای محیطی

1. فایل `.env.example` را باز کنید.
2. یک کپی از آن با نام `.env` بسازید.
3. مقادیر زیر را در فایل `.env` وارد کنید:

```
TELEGRAM_BOT_TOKEN=توکن-ربات-تلگرام
TRELLO_API_KEY=کلید-api-تروللو
TRELLO_API_TOKEN=توکن-api-تروللو
TRELLO_DEFAULT_LIST_NAME=Inbox
```

> اگر دوست داشتید نام لیست پیش‌فرض چیز دیگری باشد (مثلاً "ورودی‌ها"), مقدار `TRELLO_DEFAULT_LIST_NAME` را تغییر دهید.

---

## قدم چهار: نصب وابستگی‌ها و اجرای ربات

در همان ترمینال فعال شده، دستورات زیر را وارد کنید:

```bash
# نصب کتابخانه‌های موردنیاز
pip install -r requirements.txt

# اجرای ربات
python -m bot.main
```

اگر همه‌چیز درست باشد، در ترمینال پیغام `Bot is starting` را می‌بینید و ربات روشن است.

برای خاموش کردن ربات کافی است در ترمینال کلیدهای `Ctrl + C` را بزنید.

---

## قدم پنج: شیوه کار با ربات

1. در تلگرام، پنجره گفت‌وگو با ربات را باز کنید و دستور `/start` را بفرستید.
2. ربات برای شما یک برد خصوصی در Trello با نامی مثل `TaskMate Telegram Workspace #123456789` می‌سازد.
3. از این لحظه هر پیام متنی را بفرستید:
   - خط اول پیام عنوان کارت می‌شود.
   - خطوط بعدی توضیحات کارت هستند.
   - کارت جدید در لیست `Inbox` برد شما ساخته می‌شود.
4. اگر عکس بفرستید، یک کارت جدید با عکس پیوست شده ساخته می‌شود.
5. اگر ویس بفرستید، فایل صوتی به عنوان پیوست کارت ذخیره می‌شود.
6. از طریق وب‌سایت یا اپلیکیشن Trello می‌توانید کارت‌ها را جابه‌جا کنید، اعضا اضافه کنید یا وضعیت آن‌ها را تغییر دهید.

> فعلاً هر پیام یک کارت جدید می‌سازد. در ادامهٔ نقشه راه یاد می‌گیرید چطور فرمان‌های پیچیده‌تر (مثل Done کردن یا آپدیت کارت موجود) اضافه کنید.

---

## عیب‌یابی سریع

| مشکل | راه‌حل پیشنهادی |
|------|------------------|
| پیام «Missing required environment variables» | فایل `.env` را بررسی کنید؛ شاید مقدارها را اشتباه نوشته باشید یا فایل در همان پوشهٔ پروژه نباشد. |
| پیام «در اتصال به Trello خطایی رخ داد» | از اتصال اینترنت مطمئن شوید. سپس وارد وب‌سایت Trello شوید و بررسی کنید API Token هنوز معتبر است. در صورت نیاز دوباره Token بسازید. |
| عکس یا ویس ذخیره نمی‌شود | اطمینان حاصل کنید ربات به پیام‌های مدیا دسترسی دارد. اگر از سرور بدون فضای کافی استفاده می‌کنید، فضای دیسک را چک کنید. |
| اجرا شدن ربات متوقف می‌شود | ترمینال را بررسی کنید؛ ممکن است خطای دیگری چاپ شده باشد. برای راهنمایی بیشتر می‌توانید Issues باز کنید. |

---

## نقشه راه گسترش فاز یک

برای اینکه به تدریج امکانات بیشتری اضافه کنیم، پیشنهاد می‌شود مراحل زیر را دنبال کنید:

1. **پشتیبانی از ابزارهای بیشتر:** ساخت ماژول‌های مشابه Trello برای ابزارهایی مثل ClickUp، Notion یا Asana که API رایگان دارند.
2. **فرمان‌های متنی پیشرفته:** تعریف الگوهایی مثل `done #123` برای بستن کارت یا `comment #123 متن` برای افزودن نظر.
3. **مدیریت زبان طبیعی:** استفاده از کتابخانه‌های ساده NLP برای تشخیص نیت کاربر از روی متن و تبدیل خودکار به عملیات مناسب.
4. **ارسال خلاصه روزانه:** هر روز صبح گزارش کارت‌های ایجاد شده یا وضعیت تسک‌های معوق را به کاربر ارسال کنید.
5. **بهبود امنیت:** ذخیره امن‌تر Tokenها و امکان چرخش خودکار آن‌ها.

هرکدام از این مراحل را می‌توانید در شاخه‌های جداگانه Git پیاده کنید تا تاریخچه تمیز بماند.

---

## نگاه به آینده (فازهای بعدی)

وقتی فاز اول پایدار شد، می‌توانیم به سراغ اهداف بلندمدت برویم:

- **فاز ۲:** طراحی دیتابیس داخلی برای نگهداری اطلاعات کاربران و تسک‌ها، بدون وابستگی کامل به سرویس‌های بیرونی.
- **فاز ۳:** تبدیل شدن به نرم‌افزار مدیریت پروژه مستقل با امکان ساخت تیم، دعوت همکاران و اشتراک‌گذاری بردها.
- **فاز ۴:** اضافه کردن داشبورد وب، تحلیل عملکرد تیم‌ها، گزارش‌های پیشرفته و ادغام با سرویس‌های پیام‌رسان دیگر.

تا آن زمان، همین ربات تلگرام پایه‌ای محکم برای آزمایش ایده و جمع‌آوری بازخورد کاربران فراهم می‌کند.

---

## ساختار پروژه

```
TaskMateAi/
├── bot/
│   ├── __init__.py
│   ├── config.py          # مدیریت متغیرهای محیطی
│   ├── main.py            # نقطه ورود ربات تلگرام و هندلرها
│   ├── storage.py         # ذخیره‌سازی ساده اطلاعات کاربران در فایل JSON
│   ├── trello_client.py   # توابع ارتباط با API ترلو
│   └── workspace.py       # ساخت و مدیریت فضای کار هر کاربر
├── data/
│   └── .gitkeep           # پوشه‌ای برای ذخیره فایل user_workspaces.json
├── docs/                  # می‌توانید راهنماهای بیشتر اینجا قرار دهید
├── requirements.txt       # وابستگی‌های پایتون
├── .env.example           # قالب متغیرهای محیطی
├── .gitignore
└── README.md
```

اگر سؤالی داشتید یا به کمک بیشتری نیاز داشتید، می‌توانید Issue جدید باز کنید یا سؤال‌تان را همین‌جا مطرح کنید. موفق باشید! 🚀
